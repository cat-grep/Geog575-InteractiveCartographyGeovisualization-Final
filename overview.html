<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Basic document metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Page title (browser tab + assistive tech) -->
    <title>Canada Fraud Watch - The Big Picture</title>

    <!-- Favicon for browser tab -->
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="./lib/bootstrap.min.css">

    <!-- Shared site-wide styles -->
    <link rel="stylesheet" href="css/style.css">

    <!-- Page-specific layout and styling for overview view -->
    <link rel="stylesheet" href="css/overview.css">

    <!-- Google Fonts preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Project fonts: Exo 2 + Josefin Slab -->
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&family=Josefin+Slab:ital,wght@0,100..700;1,100..700&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Global navigation bar shared across pages -->
    <nav class="navbar navbar-expand-md navbar-dark bg-dark border-bottom">
        <div class="container-fluid">
            <!-- Brand / home link -->
            <a class="navbar-brand fw-bold text-light" href="index.html">
                <img src="/img/favicon.ico" width="35" height="35" class="d-inline-block align-top" alt="icon">
                Canada Fraud Watch
            </a>

            <!-- Mobile toggle button (shows/hides nav on small screens) -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar"
                aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Nav links (right aligned on larger screens) -->
            <div class="collapse navbar-collapse justify-content-end" id="mainNavbar">
                <ul class="navbar-nav mb-2 mb-lg-0">
                    <!-- Link back to personal risk view -->
                    <li class="nav-item">
                        <a class="nav-link text-light" href="index.html">Personal Risk</a>
                    </li>
                    <!-- Current page visually marked as active -->
                    <li class="nav-item">
                        <!-- mark current page as active -->
                        <a class="nav-link active text-white bg-success rounded px-3" aria-current="page"
                            href="overview.html">
                            The Big Picture
                        </a>
                    </li>
                    <!-- Link to region comparison dashboard -->
                    <li class="nav-item">
                        <a class="nav-link text-light" href="comparison.html">Side-by-Side</a>
                    </li>
                    <!-- Link to educational content -->
                    <li class="nav-item">
                        <a class="nav-link text-light" href="info.html">Learn About Fraud</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main layout container for overview dashboard -->
    <div class="container-fluid mt-3 d-flex flex-column" id="main-content">
        <div class="row g-3 h-100">
            <!-- Left column: map + legend + cases/loss toggle -->
            <div class="col-lg-6 d-flex">
                <div class="panel w-100 border rounded-3 shadow-sm p-3 d-flex flex-column" id="mapPanel"
                    style="min-height: 500px;">
                    <!-- Panel header: title + value toggle buttons -->
                    <div class="panel-title d-flex justify-content-between align-items-center">
                        <h2>Nationwide Fraud Overview</h2>
                        <div class="btn-group" role="group">
                            <!-- Button toggles map + charts to show case counts -->
                            <button type="button" class="btn btn-sm btn-success" id="btnCase">Cases</button>
                            <!-- Button toggles view to show total financial loss -->
                            <button type="button" class="btn btn-sm" id="btnLoss">Loss ($)</button>
                        </div>
                    </div>

                    <!-- Dynamic subtitle summarizing current filters / metric -->
                    <div class="panel-subtitle" id="mapSubtitle"></div>

                    <!-- Map container: holds SVG and legend overlay -->
                    <div id="mapContainer" class="flex-grow-1 position-relative">
                        <!-- Main choropleth / map SVG rendered via D3 -->
                        <svg id="map" class="w-100 h-100" style="display:block;"></svg>

                        <!-- Map legend (color ramp + numeric scale) -->
                        <div id="mapLegend">
                            <!-- Legend title (e.g., "Cases per 100k") -->
                            <div id="legendLabel"></div>
                            <!-- Color gradient representing value range -->
                            <div id="mapLegendGradient"></div>
                            <!-- Min/max values aligned with gradient -->
                            <div id="legendScale" class="d-flex justify-content-between">
                                <span id="legendMin">0</span>
                                <span id="legendMax">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right column: small multiples (bars, trend, gender, age) -->
            <div class="col-lg-6">
                <div class="d-flex flex-column gap-3 h-100">

                    <!-- First row: top regions + overall trend -->
                    <div class="row g-3 flex-grow-1">
                        <!-- Bar chart panel: top regions by current metric -->
                        <div class="col-md-6">
                            <div class="panel h-100 border rounded-3 shadow-sm p-3 d-flex flex-column"
                                id="barChartContainer">
                                <div class="panel-title">
                                    <h4>Top regions</h4>
                                </div>
                                <!-- SVG height controlled by container min-height -->
                                <div class="flex-grow-1" style="min-height: 200px;">
                                    <svg id="barChart" class="w-100"></svg>
                                </div>
                            </div>
                        </div>

                        <!-- Time trend panel: all-years trend with reset button -->
                        <div class="col-md-6">
                            <div class="panel h-100 border rounded-3 shadow-sm p-3 d-flex flex-column"
                                id="trendChartContainer">
                                <div class="panel-title d-flex justify-content-between align-items-center">
                                    <h4>Trend over time</h4>
                                    <!-- Button resets timeline selection back to full period -->
                                    <button id="allYearsBtn" class="selectAllBtn active rounded" type="button">All
                                        Years</button>
                                </div>
                                <div class="flex-grow-1" style="min-height: 200px;">
                                    <!-- Overall trend (cases or losses) rendered via D3 -->
                                    <svg id="trendChart" class="w-100 h-100"></svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Second row: gender and age distribution -->
                    <div class="row g-3 flex-grow-1">
                        <!-- Gender share panel (e.g., stacked bar or donut) -->
                        <div class="col-md-6">
                            <div class="panel h-100 border rounded-3 shadow-sm p-3 d-flex flex-column"
                                id="genderChartContainer">
                                <div class="panel-title d-flex justify-content-between align-items-center">
                                    <h4>Share by Gender</h4>
                                    <!-- Button selects all genders (clears any active filter) -->
                                    <button id="allGendersBtn" class="selectAllBtn active rounded" type="button">All
                                        Genders</button>
                                </div>
                                <div class="flex-grow-1" style="min-height: 200px;">
                                    <!-- Gender breakdown SVG (built in overview.js) -->
                                    <svg id="genderChart" class="w-100 h-100"></svg>
                                </div>
                            </div>
                        </div>

                        <!-- Age group share panel (donut or bar) -->
                        <div class="col-md-6">
                            <div class="panel h-100 border rounded-3 shadow-sm p-3 d-flex flex-column"
                                id="donutContainer">
                                <div class="panel-title d-flex justify-content-between align-items-center">
                                    <h4>Share by Age Group</h4>
                                    <!-- Button selects all age groups (clears filter) -->
                                    <button id="allAgesBtn" class="selectAllBtn active rounded" type="button">All
                                        Ages</button>
                                </div>
                                <div class="flex-grow-1" style="min-height: 200px;">
                                    <!-- Age-group donut or bar chart rendered via D3 -->
                                    <svg id="donutChart" class="w-100 h-100"></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Shared tooltip for all charts and map (positioned by JS) -->
    <div class="chart-tooltip" id="tooltip" style="display:none"></div>

    <!-- Site footer: credits, data sources, and caveats -->
    <footer class="mt-5 pt-4 pb-3 bg-dark text-light">
        <div class="col-10 mx-auto">
            <div class="row small">
                <!-- Project credits / authorship -->
                <div class="col-12 col-md-4 mb-3 mb-md-0">
                    <h6 class="text-uppercase fw-bold mb-1">Credits</h6>
                    <p class="mb-0">
                        Design & Development: Eugenie Huang, Elijah Gardner Woods, Darbie Gibbs<br>
                        Dashboard created for UW Madison GEOG 575 course Fall 2025.
                    </p>
                </div>

                <!-- Official data sources with external links -->
                <div class="col-12 col-md-4 mb-3 mb-md-0">
                    <h6 class="text-uppercase fw-bold mb-1">Data sources</h6>
                    <p class="mb-0">
                        <a href="https://open.canada.ca/data/en/dataset/6a09c998-cddb-4a22-beff-4dca67ab892f/resource/43c67af5-e598-4a9b-a484-fe1cb5d775b5"
                            target="_blank">Centre reporting data</a><br />
                        <a href="https://www12.statcan.gc.ca/census-recensement/2021/geo/sip-pis/boundary-limites/index2021-eng.cfm?year=21"
                            target="_blank">Statistics Canada: 2021 Census â€“ Boundary files</a><br />
                    </p>
                </div>

                <!-- Methodological notes / disclaimers -->
                <div class="col-12 col-md-4">
                    <h6 class="text-uppercase fw-bold mb-1">Notes</h6>
                    <p class="mb-0">
                        Figures are based on reported cases only and do not capture
                        unreported fraud incidents.
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- JS dependencies (loaded at end of body for performance) -->

    <!-- jQuery (required by current Bootstrap JS setup in this project) -->
    <script type="text/javascript" src="lib/jquery-3.5.1.js"></script>

    <!-- Bootstrap JS bundle (includes Popper) -->
    <script type="text/javascript" src="lib/bootstrap.min.js"></script>

    <!-- D3 + topojson from CDN: used for all chart + map rendering -->
    <script src="https://unpkg.com/d3@7/dist/d3.min.js"></script>
    <script src="https://unpkg.com/topojson-client@3/dist/topojson-client.min.js"></script>

    <!-- Page-specific JavaScript: data loading, filtering, and visual updates for overview page -->
    <script type="text/javascript" src="js/overview.js"></script>

</body>

</html>